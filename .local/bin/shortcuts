#!/usr/bin/env bash
# This script is used to create a shortcut to a file and open in nvim

file=$(cat /home/$USER/.config/shell/shortcuts | fzf)
if [ -n "$file" ]; then
	# expand ~ to $HOME
	file="${file/#\~/$HOME}"
	# check if the file exists
	if [ -e "$file" ]; then
		# get the directory of the file
		dir=$(dirname "$file")
		# get the absolute path of the directory
		real_dir=$(cd "$dir"; pwd)
		# check if the directory is a subdirectory of the $HOME directory
		if [[ "$real_dir" == "$HOME/"* ]]; then
			echo "yes"
			cd "$dir"
			nvim "$file"
		else
			echo "no"
			cd "$dir"
			SUDO_ASKPASS=~/.local/bin/dmenupass sudo -A nvim "$file"
		fi
	else
		echo "File does not exist"
	fi
fi

# cd /home/$USER/
# echo "Running first fzf"
# file=$(cat /home/$USER/.config/shell/shortcuts | fzf)
# if [ -n "$file" ]; then
#   cd "$(dirname "$file")"
#   nvim "$file"
# else
#   echo "First fzf cancelled or no file selected, running second fzf"
# 	read -t 1 -n 1
#   file="$(fzf)"
#   if [ -n "$file" ]; then
#     echo "File selected: $file"
#     echo "/home/$USER/$file" >> /home/$USER/Dropbox/NOTES/Shortcuts.md
#     cd "$(dirname "$file")"
#     nvim "$file"
#   else
#     echo "No file selected after second fzf"
#     exit 1
#   fi
# fi
