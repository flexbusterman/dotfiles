#!/bin/bash
running=false
ps -C calcurse >/dev/null && running=true
ps -C calcurse-caldav >/dev/null && running=true
STATUS=$(mullvad status | awk '{print $NF}')
if [[ $STATUS == "Connected" ]]; then
	running=true
fi

if [[ $running == true ]]; then
	echo "Not updating because vpn, caldav is running or calendar is already updating"
	notify-send "Not updating because vpn, caldav is running or calendar is already updating"
else
	notify-send "Updating calendar"
	rm /home/flex/.calcurse/caldav/lock
	CALCURSE_CALDAV_PASSWORD=$(cat ~/.netrcs/.calendar) calcurse-caldav && echo "Updated calendar" 
fi
