#!/bin/bash

validArguments=("bar" "gaps" "focus")

# check if argument is valid
if [[ " ${validArguments[*]} " =~ " $1 " ]]; then
	# if file for argument doesnt exist
	if [ ! -f "/home/$USER/.config/i3/$1" ]; then
		echo "create file for argument containing true"
		echo "true" > /home/$USER/.config/i3/$1
	fi
else
	echo "Argument has to be bar, gaps or focus"
	exit 1
fi

case $1 in
	bar)
		bar=$(cat /home/$USER/.config/i3/bar | while read line; do echo $line; done)
		if [[ $bar == "false" ]]; then
			pidof polybar || polybar mybar -c $HOME/.config/polybar/config.ini 2>&1 | tee -a /tmp/polybar.log & disown
			polybar-msg cmd show
			echo "true" > ~/.config/i3/bar
		else
			echo "false" > ~/.config/i3/bar
			polybar-msg cmd hide
		fi
		echo $focus
		;;

	gaps)
		gaps=$(cat /home/$USER/.config/i3/gaps | while read line; do echo $line; done)
		if [[ $gaps == "true" ]]; then
			i3-msg gaps inner all set 0
			i3-msg gaps outer all set 0
			echo "false" > ~/.config/i3/gaps
		else
			echo "true" > ~/.config/i3/gaps
			i3-msg gaps inner all set 24
			i3-msg gaps outer all set 0
		fi
		;;

	focus)
		focus=$(cat /home/$USER/.config/i3/focus | while read line; do echo $line; done)
		if [[ $focus == "true" ]]; then
			i3-msg gaps inner all set 0
			i3-msg gaps outer all set 0
			pidof polybar || polybar mybar -c $HOME/.config/polybar/config.ini 2>&1 | tee -a /tmp/polybar.log & disown
			polybar-msg cmd show
			echo "false" > ~/.config/i3/focus
			echo "true" > ~/.config/i3/bar
		else
			i3-msg gaps inner all set 24
			i3-msg gaps outer all set 0
			polybar-msg cmd hide
			echo "true" > ~/.config/i3/focus
			echo "false" > ~/.config/i3/bar
		fi
		;;

	*)
		echo -n "Unknown argument, this code should not be run"
		exit 1
		;;
esac
